{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function renderImagesCard(data, cardContainer) {\n    if (data.hits && data.hits.length > 0) {\n      const markup = data.hits\n        .map(\n          ({\n            webformatURL,\n            largeImageURL,\n            likes,\n            views,\n            comments,\n            downloads,\n            tags,\n          }) => {\n            const tagsString = tags.split(',').join(', ');\n            return `<div class=\"card\">\n              <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tagsString}\" />\n              </a>\n            <div class=\"card-properties\">\n                <ul class=\"card-list\">\n                    <li>Likes <span class=\"accent-item\">${likes}</span></li>\n                    <li>Views <span class=\"accent-item\">${views}</span></li>\n                    <li>Comments <span class=\"accent-item\">${comments}</span></li>\n                    <li>Downloads <span class=\"accent-item\">${downloads}</span></li>\n                </ul>\n            </div>\n            </div>`;\n          }\n        )\n        .join('');\n  \n      cardContainer.insertAdjacentHTML('beforeend', markup);\n  \n      const lightbox = new SimpleLightbox('.card-container a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n  \n      lightbox.refresh();\n    } else {\n      showErrorMessage('Sorry, there are no images matching your search query. Please try again!');\n    }\n  }\n  \n  export function showLoadingIndicator(loading) {\n    loading.style.display = 'block';\n  }\n  \n  export function hideLoadingIndicator(loading) {\n    loading.style.display = 'none';\n  }\n  \n  export function showErrorMessage(message) {\n    iziToast.error({\n      message: message,\n      position: 'topRight',\n      titleColor: 'white',\n      messageColor: 'white',\n      timeout: 5000,\n      backgroundColor: '#EF4040',\n    });\n  }","import axios from 'axios';\n\nexport async function fetchImages(query, page = 1, perPage = 40) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '48242250-abd806f4b021d280ea207da17';\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        per_page: perPage,\n        page: page,\n        orientation: 'horizontal',\n        safesearch: true,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw new Error(`Error fetching images: ${error.message}`);\n  }\n}\n","import {\n  renderImagesCard,\n  showLoadingIndicator,\n  hideLoadingIndicator,\n  showErrorMessage,\n} from './js/render-functions.js';\n\nimport { fetchImages } from './js/pixabay-api.js';\n\nconst cardContainer = document.querySelector('.card-container');\nconst searchForm = document.querySelector('.search-form');\nconst loading = document.querySelector('.loader');\nconst btnLoad = document.querySelector('.btn-load');\n\nlet page = 1;\nlet limit = 40;\nlet query = '';\nlet totalHits = 0;\n\nsearchForm.addEventListener('submit', handleSearch);\nbtnLoad.addEventListener('click', loadMoreImages);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n  query = form.elements.query.value.trim();\n\n  if (!query) {\n    showErrorMessage('Please enter a valid search query.');\n    return;\n  }\n\n  page = 1;\n  cardContainer.innerHTML = '';\n\n  showLoadingIndicator(loading);\n  btnLoad.classList.add('is-hidden');\n\n  try {\n    const data = await fetchImages(query, page, limit);\n    renderImagesCard(data, cardContainer);\n    totalHits = data.totalHits;\n\n   if (page < Math.ceil(totalHits / limit)) {\n      btnLoad.classList.remove('is-hidden');\n    } else {\n      btnLoad.classList.add('is-hidden');\n    }\n\n    page += 1;\n  } catch (err) {\n    onFetchError();\n  } finally {\n    form.reset();\n    hideLoadingIndicator(loading);\n  }\n}\n\nasync function loadMoreImages() {\n  if (page > Math.ceil(totalHits / limit)) {\n    iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, there are no more posts to load\",\n    });\n    btnLoad.classList.add('is-hidden');\n    return;\n  }\n\n  showLoadingIndicator(loading);\n\n  try {\n    const data = await fetchImages(query, page, limit);\n    renderImagesCard(data, cardContainer);\n\n    const liEl = cardContainer.querySelector('li');\n    if (liEl) {\n      const { height } = liEl.getBoundingClientRect();\n      smoothScrollImages(height * 8, 0);\n    }\n\n    page += 1;\n\n    if (page > Math.ceil(totalHits / limit)) {\n      btnLoad.classList.add('is-hidden');\n      iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        backgroundColor: 'blue',\n      });\n    }\n  } catch (err) {\n    onFetchError();\n  } finally {\n    hideLoadingIndicator(loading);\n  }\n}\n\nfunction onFetchError() {\n  showErrorMessage(\n    'Sorry, there was an error with the request. Please try again later.'\n  );\n}\n\nfunction smoothScrollImages(top, left = 0) {\n  window.scrollBy({ top, left, behavior: 'smooth' });\n}\n"],"names":["renderImagesCard","data","cardContainer","markup","webformatURL","largeImageURL","likes","views","comments","downloads","tags","tagsString","SimpleLightbox","showErrorMessage","showLoadingIndicator","loading","hideLoadingIndicator","message","iziToast","fetchImages","query","page","perPage","BASE_URL","API_KEY","axios","error","searchForm","btnLoad","limit","totalHits","handleSearch","loadMoreImages","event","form","onFetchError","liEl","height","smoothScrollImages","top","left"],"mappings":"owBAKO,SAASA,EAAiBC,EAAMC,EAAe,CAClD,GAAID,EAAK,MAAQA,EAAK,KAAK,OAAS,EAAG,CACrC,MAAME,EAASF,EAAK,KACjB,IACC,CAAC,CACC,aAAAG,EACA,cAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,EACA,KAAAC,CACZ,IAAgB,CACJ,MAAMC,EAAaD,EAAK,MAAM,GAAG,EAAE,KAAK,IAAI,EAC5C,MAAO;AAAA,yBACML,CAAa;AAAA,4BACVD,CAAY,UAAUO,CAAU;AAAA;AAAA;AAAA;AAAA,0DAIFL,CAAK;AAAA,0DACLC,CAAK;AAAA,6DACFC,CAAQ;AAAA,8DACPC,CAAS;AAAA;AAAA;AAAA,mBAI5D,CACF,EACA,KAAK,EAAE,EAEVP,EAAc,mBAAmB,YAAaC,CAAM,EAEnC,IAAIS,EAAe,oBAAqB,CACvD,aAAc,MACd,aAAc,GACtB,CAAO,EAEQ,QAAO,CACtB,MACMC,EAAiB,0EAA0E,CAE9F,CAEM,SAASC,EAAqBC,EAAS,CAC5CA,EAAQ,MAAM,QAAU,OACzB,CAEM,SAASC,EAAqBD,EAAS,CAC5CA,EAAQ,MAAM,QAAU,MACzB,CAEM,SAASF,EAAiBI,EAAS,CACxCC,EAAS,MAAM,CACb,QAASD,EACT,SAAU,WACV,WAAY,QACZ,aAAc,QACd,QAAS,IACT,gBAAiB,SACvB,CAAK,CACL,CChEO,eAAeE,EAAYC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CAC/D,MAAMC,EAAW,2BACXC,EAAU,qCAChB,GAAI,CAYF,OAXiB,MAAMC,EAAM,IAAIF,EAAU,CACzC,OAAQ,CACN,IAAKC,EACL,EAAGJ,EACH,WAAY,QACZ,SAAUE,EACV,KAAMD,EACN,YAAa,aACb,WAAY,EACb,CACP,CAAK,GACe,IACjB,OAAQK,EAAO,CACd,MAAM,IAAI,MAAM,0BAA0BA,EAAM,OAAO,EAAE,CAC1D,CACH,CCZA,MAAMxB,EAAgB,SAAS,cAAc,iBAAiB,EACxDyB,EAAa,SAAS,cAAc,cAAc,EAClDZ,EAAU,SAAS,cAAc,SAAS,EAC1Ca,EAAU,SAAS,cAAc,WAAW,EAElD,IAAIP,EAAO,EACPQ,EAAQ,GACRT,EAAQ,GACRU,EAAY,EAEhBH,EAAW,iBAAiB,SAAUI,CAAY,EAClDH,EAAQ,iBAAiB,QAASI,CAAc,EAEhD,eAAeD,EAAaE,EAAO,CACjCA,EAAM,eAAc,EAEpB,MAAMC,EAAOD,EAAM,cAGnB,GAFAb,EAAQc,EAAK,SAAS,MAAM,MAAM,KAAI,EAElC,CAACd,EAAO,CACVP,EAAiB,oCAAoC,EACrD,MACD,CAEDQ,EAAO,EACPnB,EAAc,UAAY,GAE1BY,EAAqBC,CAAO,EAC5Ba,EAAQ,UAAU,IAAI,WAAW,EAEjC,GAAI,CACF,MAAM3B,EAAO,MAAMkB,EAAYC,EAAOC,EAAMQ,CAAK,EACjD7B,EAAiBC,EAAMC,CAAa,EACpC4B,EAAY7B,EAAK,UAEdoB,EAAO,KAAK,KAAKS,EAAYD,CAAK,EACnCD,EAAQ,UAAU,OAAO,WAAW,EAEpCA,EAAQ,UAAU,IAAI,WAAW,EAGnCP,GAAQ,CACT,MAAa,CACZc,GACJ,QAAY,CACRD,EAAK,MAAK,EACVlB,EAAqBD,CAAO,CAC7B,CACH,CAEA,eAAeiB,GAAiB,CAC9B,GAAIX,EAAO,KAAK,KAAKS,EAAYD,CAAK,EAAG,CACvC,SAAS,MAAM,CACb,SAAU,WACV,QAAS,8CACf,CAAK,EACDD,EAAQ,UAAU,IAAI,WAAW,EACjC,MACD,CAEDd,EAAqBC,CAAO,EAE5B,GAAI,CACF,MAAMd,EAAO,MAAMkB,EAAYC,EAAOC,EAAMQ,CAAK,EACjD7B,EAAiBC,EAAMC,CAAa,EAEpC,MAAMkC,EAAOlC,EAAc,cAAc,IAAI,EAC7C,GAAIkC,EAAM,CACR,KAAM,CAAE,OAAAC,CAAM,EAAKD,EAAK,sBAAqB,EAC7CE,EAAmBD,EAAS,EAAG,CAAC,CACjC,CAEDhB,GAAQ,EAEJA,EAAO,KAAK,KAAKS,EAAYD,CAAK,IACpCD,EAAQ,UAAU,IAAI,WAAW,EACjC,SAAS,MAAM,CACb,QAAS,6DACT,SAAU,WACV,gBAAiB,MACzB,CAAO,EAEJ,MAAa,CACZO,GACJ,QAAY,CACRnB,EAAqBD,CAAO,CAC7B,CACH,CAEA,SAASoB,GAAe,CACtBtB,EACE,qEACJ,CACA,CAEA,SAASyB,EAAmBC,EAAKC,EAAO,EAAG,CACzC,OAAO,SAAS,CAAE,IAAAD,EAAK,KAAAC,EAAM,SAAU,QAAQ,CAAE,CACnD"}